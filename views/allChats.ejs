<%- include('layout') -%>

<div class="container">
  <h2>Your Chats</h2>
  <div class="chats">
    <% if (chat) { %>
      <div class="chat-card" onclick="openChat('<%= chat._id %>')">
        <img src="<%= chat.users[1]._id === currentUser._id ? chat.users[0].pic : chat.users[1].pic %>" alt="<%= chat.users[1]._id === currentUser._id ? chat.users[0].name : chat.users[1].name %>">
        <div class="chat-info">
          <h4><%= chat.users[1]._id === currentUser._id ? chat.users[0].name : chat.users[1].name %></h4>
          <p><%= chat.latestMessage ? chat.latestMessage.content : "No messages yet" %></p>
        </div>
      </div>
    <% } else { %>
      <p>No chats available.</p>
    <% } %>
  </div>
</div>

<script>
  function openChat(chatId) {
    window.location.href = `/chat?id=${chatId}`;
  }
</script>

<style>
  .container {
    margin: 20px;
  }
  .chats {
    display: flex;
    flex-direction: column;
  }
  .chat-card {
    display: flex;
    align-items: center;
    padding: 10px;
    border: 1px solid #ccc;
    margin-bottom: 10px;
    cursor: pointer;
  }
  .chat-card img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 10px;
  }
  .chat-info {
    display: flex;
    flex-direction: column;
  }
  .chat-info h4 {
    margin: 0;
  }
  .chat-info p {
    margin: 0;
    color: gray;
  }
</style>
